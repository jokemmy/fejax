!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.fejax=r()}(this,function(){"use strict";var n=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function o(e){return!0==(null!=(r=e)&&"object"==typeof r&&!1===Array.isArray(r))&&"[object Object]"===Object.prototype.toString.call(e);var r}var u=Object.prototype.toString,t=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var r,t,n,o,a,i=typeof e;if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return"GeneratorFunction"===c(e)?"generatorfunction":"function";if(r=e,Array.isArray?Array.isArray(r):r instanceof Array)return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!=e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if((t=e)instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate)return"date";if((n=e)instanceof Error||"string"==typeof n.message&&n.constructor&&"number"==typeof n.constructor.stackTraceLimit)return"error";if((o=e)instanceof RegExp||"string"==typeof o.flags&&"boolean"==typeof o.ignoreCase&&"boolean"==typeof o.multiline&&"boolean"==typeof o.global)return"regexp";switch(c(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof(a=e).throw&&"function"==typeof a.return&&"function"==typeof a.next)return"generator";switch(i=u.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")};function c(e){return e.constructor?e.constructor.name:null}var a={};["Array","Number","Function","RegExp","Boolean","Date","Error","Arguments","Null","String"].forEach(function(r){a[r]=function(e){return t(e)===r.toLowerCase()}});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var w=Object.assign(a,{Undefined:function(e){return null==e},Defined:function(e){return null!=e},Element:function(e){return"object"===(void 0===e?"undefined":r(e))&&1===e.nodeType},Window:function(e){return null!=e&&e===e.window},Document:function(e){return"object"===(void 0===e?"undefined":i(e))&&9===e.nodeType},PlainObject:function(e){var r,t;return!1!==o(e)&&"function"==typeof(r=e.constructor)&&!1!==o(t=r.prototype)&&0!=t.hasOwnProperty("isPrototypeOf")},Object:n,ArrayLike:function(e){var r,t=n(r=e)?r.length:void 0;return a.Number(t)&&0<=t&&t<=9007199254740991},isItClass:function(r){return function(e){return e instanceof r}}}),b=function(e,r){if((null==(t=e)||"object"!=typeof t||!1!==Array.isArray(t))&&"function"!=typeof e)return{};var t,n={};if("string"==typeof r)return r in e&&(n[r]=e[r]),n;for(var o=r.length,a=-1;++a<o;){var i=r[a];i in e&&(n[i]=e[i])}return n},x=function(e,r,t,n,o,a,i,u){if(!e){var c;if(void 0===r)c=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[t,n,o,a,i,u],l=0;(c=Error(r.replace(/%s/g,function(){return s[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},s=Object.prototype.hasOwnProperty,l=function(){for(var e=[],r=0;r<256;++r)e.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return e}(),f=function(e,r){for(var t=r&&r.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(t[n]=e[n]);return t},T={arrayToObject:f,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,r){return[].concat(e,r)},compact:function(e){for(var r=[{obj:{o:e},prop:"o"}],t=[],n=0;n<r.length;++n)for(var o=r[n],a=o.obj[o.prop],i=Object.keys(a),u=0;u<i.length;++u){var c=i[u],s=a[c];"object"==typeof s&&null!==s&&-1==t.indexOf(s)&&(r.push({obj:a,prop:c}),t.push(s))}return function(e){for(;1<e.length;){var r=e.pop(),t=r.obj[r.prop];if(Array.isArray(t)){for(var n=[],o=0;o<t.length;++o)void 0!==t[o]&&n.push(t[o]);r.obj[r.prop]=n}}}(r),e},decode:function(e,r,t){var n=e.replace(/\+/g," ");if("iso-8859-1"===t)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,r,t){if(0===e.length)return e;var n="string"==typeof e?e:e+"";if("iso-8859-1"===t)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var o="",a=0;a<n.length;++a){var i=n.charCodeAt(a);45!==i&&46!==i&&95!==i&&126!==i&&(i<48||57<i)&&(i<65||90<i)&&(i<97||122<i)?i<128?o+=l[i]:i<2048?o+=l[192|i>>6]+l[128|63&i]:55296<=i&&i<57344?(i=65536+((1023&i)<<10|1023&n.charCodeAt(a+=1)),o+=l[240|i>>18]+l[128|i>>12&63]+l[128|i>>6&63]+l[128|63&i]):o+=l[224|i>>12]+l[128|i>>6&63]+l[128|63&i]:o+=n.charAt(a)}return o},isBuffer:function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function n(t,o,a){if(!o)return t;if("object"!=typeof o){if(Array.isArray(t))t.push(o);else{if("object"!=typeof t)return[t,o];(a&&(a.plainObjects||a.allowPrototypes)||!s.call(Object.prototype,o))&&(t[o]=!0)}return t}if("object"!=typeof t)return[t].concat(o);var e=t;return Array.isArray(t)&&!Array.isArray(o)&&(e=f(t,a)),Array.isArray(t)&&Array.isArray(o)?(o.forEach(function(e,r){s.call(t,r)?t[r]&&"object"==typeof t[r]?t[r]=n(t[r],e,a):t.push(e):t[r]=e}),t):Object.keys(o).reduce(function(e,r){var t=o[r];return e[r]=s.call(e,r)?n(e[r],t,a):t,e},e)}},p=String.prototype.replace,y=/%20/g,S={default:"RFC3986",formatters:{RFC1738:function(e){return p.call(e,y,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},R={brackets:function(e){return e+"[]"},indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},d=Array.isArray,h=Array.prototype.push,C=function(e,r){h.apply(e,d(r)?r:[r])},m=Date.prototype.toISOString,L={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:T.encode,encodeValuesOnly:!1,indices:!1,serializeDate:function(e){return m.call(e)},skipNulls:!1,strictNullHandling:!1},E=function e(r,t,n,o,a,i,u,c,s,l,f,p,y){var d=r;if("function"==typeof u?d=u(t,d):d instanceof Date&&(d=l(d)),null===d){if(o)return i&&!p?i(t,L.encoder,y):t;d=""}if("string"==typeof d||"number"==typeof d||"boolean"==typeof d||T.isBuffer(d))return i?[f(p?t:i(t,L.encoder,y))+"="+f(i(d,L.encoder,y))]:[f(t)+"="+f(d+"")];var h,m=[];if(void 0===d)return m;if(Array.isArray(u))h=u;else{var b=Object.keys(d);h=c?b.sort(c):b}for(var v=0;v<h.length;++v){var g=h[v];a&&null===d[g]||C(m,e(d[g],Array.isArray(d)?n(t,g):t+(s?"."+g:"["+g+"]"),n,o,a,i,u,c,s,l,f,p,y))}return m},v=function(e,r){var t=e,n=r?T.assign({},r):{};if(null!=n.encoder&&"function"!=typeof n.encoder)throw new TypeError("Encoder has to be a function.");var o=void 0===n.delimiter?L.delimiter:n.delimiter,a="boolean"==typeof n.strictNullHandling?n.strictNullHandling:L.strictNullHandling,i="boolean"==typeof n.skipNulls?n.skipNulls:L.skipNulls,u="boolean"==typeof n.encode?n.encode:L.encode,c="function"==typeof n.encoder?n.encoder:L.encoder,s="function"==typeof n.sort?n.sort:null,l=void 0===n.allowDots?L.allowDots:!!n.allowDots,f="function"==typeof n.serializeDate?n.serializeDate:L.serializeDate,p="boolean"==typeof n.encodeValuesOnly?n.encodeValuesOnly:L.encodeValuesOnly,y=n.charset||L.charset;if(void 0!==n.charset&&"utf-8"!==n.charset&&"iso-8859-1"!==n.charset)throw Error("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0===n.format)n.format=S.default;else if(!Object.prototype.hasOwnProperty.call(S.formatters,n.format))throw new TypeError("Unknown format option provided.");var d,h,m=S.formatters[n.format];"function"==typeof n.filter?t=(h=n.filter)("",t):Array.isArray(n.filter)&&(d=h=n.filter);var b=[];if("object"!=typeof t||null===t)return"";var v=R[n.arrayFormat in R?n.arrayFormat:"indices"in n?n.indices?"indices":"repeat":"indices"];d||(d=Object.keys(t)),s&&d.sort(s);for(var g=0;g<d.length;++g){var j=d[g];i&&null===t[j]||C(b,E(t[j],j,v,a,i,u?c:null,h,s,l,f,m,p,y))}var O=b.join(o),A=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&(A+="iso-8859-1"===y?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),0<O.length?A+O:""},g=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},j=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return t}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},O=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)};function A(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function D(e,r,t){if(!r)return e;var n,o=void 0;if(t)o=t(r);else if(n=r,"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams)o=""+r;else{var a=[];Object.entries(r).forEach(function(e){var r=j(e,2),t=r[0],n=r[1];null!=n&&(w.Array(n)?t+="[]":n=[n],n.forEach(function(e){w.Date(e)?e=e.toISOString():w.PlainObject(e)&&(e=JSON.stringify(e)),a.push(A(t)+"="+A(e))}))}),o=a.join("&")}if(o){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1==e.indexOf("?")?"?":"&")+o}return e}function U(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];if(0===r.length)return function(e){return e};if(1===r.length)return r[0];var n=r[r.length-1],o=r.slice(0,-1);return function(){return o.reduceRight(function(e,r){return r(e)},n.apply(void 0,arguments))}}var P={XML:"text/xml; charset=utf-8",TEXT:"text/plain; charset=utf-8",JSON:"application/json; charset=utf-8",FORMDATA:"application/x-www-form-urlencoded;charset=utf-8"},F={"*":"*/*",HTML:"text/html; q=1.0, text/*; q=0.8, */*; q=0.1",TEXT:"text/plain; q=1.0, text/*; q=0.8, */*; q=0.1",XML:"application/xml; q=1.0, text/xml; q=0.8, */*; q=0.1",JSON:"application/json; q=1.0, text/*; q=0.8, */*; q=0.1",DEFAULT:"application/json; q=1.0, text/plain; q=0.8, */*; q=0.1"};function q(r){return function(e){return Object.keys(e).some(function(e){return e.toLowerCase()===r.toLowerCase()})}}function k(r,e){var t,n,o=e.headers,a=e.dataType,i=e.contentType,u=e.method;t=o,q("accept")(t)||(o.Accept=F[a.toUpperCase()]),n=o,q("content-type")(n)||"get"===u||(o["Content-Type"]=P[i.toUpperCase()]),Object.keys(o).forEach(function(e){o[e]&&r.setRequestHeader(e,o[e])})}var X=void 0;try{X=window.XMLHttpRequest?function(){return new window.XMLHttpRequest}:function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}}catch(e){X=function(){}}function M(e,r,t,n){var o={},a=["then","catch","finally"].reduce(function(t,n){return t[n]=function(e){var r=o[n];return o[n]=r?U(e,r):e,t},t},{}),i=function(e,r){var t=void 0,n=!1,o=""===e.responseType;if(r.crossOrigin){if(!o&&window.XDomainRequest)return t=new window.XDomainRequest,n=!0,r.method=r.data?"post":"get",{xhr:t,xdr:n,xhr2:o};throw Error("CrossOrigin is not support.")}return{xhr:e,xdr:n,xhr2:o}}(X(),n),u=i.xhr,y=i.xdr,d=i.xhr2,c="get"===e?D(r,t,n.paramsSerializer):r;y?u.open(e.toUpperCase(),c):u.open(e.toUpperCase(),c,n.async,n.user,n.password),d&&(u.withCredentials=n.withCredentials),"setRequestHeader"in u&&k(u,n);var s,l,h=void 0,f=void 0,p=function(){u.statusText_="timeout",(n.ontimeout||f)()};if(d?(u.timeout=n.timeout,u.ontimeout=p):h=setTimeout((s=u,l=p,function(){s.aborted||(s.abort(),l&&l(s))}),n.timeout),d)try{n.responseType&&(u.responseType=n.responseType)}catch(e){}else"overrideMimeType"in u&&u.overrideMimeType(P[n.contentType.toUpperCase()]);var m=function(){return c=d,s=y,l=h,f=u,p=n,function e(r){if(4===f.readyState){l&&clearTimeout(l),c||s?(f.onload=null,f.onerror=null):f.removeEventListener?f.removeEventListener("readystatechange",e,!1):f.onreadystatechange=null;var t=function(e,r,t){var n=t(e.status),o=null,a=null;if(e.response||e.responseType&&"text"!==e.responseType||(e.response=e.responseText),n)try{null===(o=r(e))?(n=!1,a="parseerror"):o=e.response}catch(e){n=!1,a="parseerror"}else a=e.statusText;return{success:n,result:o,error:a}}(f,(i=(a=p).dataType,u=a.responseType,function(e){return"default"===i?e.response||e.responseText:"*"===i?u?e.response:e.responseText:["xml","html"].includes(i)?e.responseXML||e.response:["json","text"].includes(i)?e.response||e.responseText:e.response}),p.validateStatus),n=t.result,o=t.error;t.success?r.then&&r.then(n,f):r.catch&&r.catch(o,f),r.finally&&r.finally(o,n,f)}var a,i,u}(o);var c,s,l,f,p};return f=m,d||y?(u.onload=m,u.onerror=m,u.onabort=m,y&&(u.onprogress=function(){})):u.addEventListener?u.addEventListener("readystatechange",m,!1):u.onreadystatechange=m,d&&(u.addEventListener("progress",n.onDownloadProgress),d&&u.upload&&u.upload.addEventListener("progress",n.onUploadProgress)),"formdata"===n.contentType&&w.PlainObject(t)?u.send(n.paramsSerializer(t)):"formdata"===n.contentType?u.send(t||null):"json"===n.contentType&&w.PlainObject(t)?u.send(JSON.stringify(t)):u.send(t||null),a.abort=function(){u.aborted||(h&&clearTimeout(h),u.aborted=!0,u.abort())},n.signal&&(n.signal.onabort=function(){a.abort()},u=null),a}var N={method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},timeout:1e4,ontimeout:null,baseUrl:"",data:null,url:"",withCredentials:!1,crossDomain:!1,user:"",password:"",dataType:"default",contentType:"formdata",cache:"default",signal:null,validateStatus:function(e){return 200<=e&&e<300},transformResponse:[function(e,r){return e}],transformRequest:[function(e){return e}],paramsSerializer:function(e){return v(e,{arrayFormat:"brackets"})},onUploadProgress:function(e){},onDownloadProgress:function(e){}};var I=U(function(e){return M(e.method,e.baseUrl+e.url,e.data,e)},function(e){var r=e.method,t=e.headers,n=e.timeout,o=e.ontimeout,a=e.baseUrl,i=e.data,u=e.url,c=e.withCredentials,s=e.crossDomain,l=e.user,f=e.password,p=e.dataType,y=e.contentType,d=e.cache,h=e.signal,m=e.validateStatus,b=e.transformResponse,v=e.transformRequest,g=e.paramsSerializer,j=e.onUploadProgress,O=e.onDownloadProgress,A=Object.assign({},N);return A.headers=Object.assign({},A.headers),w.String(r)&&r&&(A.method=r.toLowerCase()),w.PlainObject(t)&&Object.assign(A.headers,t),w.Number(n)&&isFinite(n)&&(A.timeout=Math.max(0,n)),w.Function(o)&&(A.ontimeout=o),w.String(a)&&a&&(A.baseUrl=a),w.String(u)&&u&&(A.url=u),A.withCredentials=!!c,A.crossDomain=!!s,A.crossDomain||"XMLHttpRequest"!==A.headers["X-Requested-With"]||delete A.headers["X-Requested-With"],w.String(l)&&l&&(A.user=l,w.String(f)&&(A.password=f)),w.String(p)&&(["*","xml","json","text","html"].includes(p.toLowerCase())?A.dataType=p:"document"===p.toLowerCase()?A.dataType="html":["arraybuffer","blob","stream"].includes(p.toLowerCase())&&(A.dataType="*")),w.String(p)&&(["xml","html"].includes(p.toLowerCase())?A.responseType="document":["arraybuffer","blob","document","json","text","stream"].includes(p.toLowerCase())&&(A.responseType=p)),w.String(y)&&"get"!==A.method&&["xml","json","text","formdata"].includes(y.toLowerCase())&&(A.contentType=y),i&&(A.data=i),w.Object(t)&&(d&&"default"!==d&&"no-cache"===(A.headers["Cache-Control"]=d)&&(A.headers.Pragma="no-cache"),A.cache=d||A.cache),A.async=!0,h&&(A.signal=h),w.Function(m)&&(A.validateStatus=m),w.Array(b)&&(A.transformResponse=b),w.Array(v)&&(A.transformRequest=v),w.Function(g)&&(A.paramsSerializer=g),w.Function(j)&&(A.onUploadProgress=j),w.Function(O)&&(A.onDownloadProgress=O),x(A.url||A.baseUrl,"Url or BaseUrl must be a non-empty string."),A});var H,B=Symbol("ajax"),z=Symbol("ajaxHandler"),W=(H=B,function(e){return e[H]}),V=["ajax","get","post","put","delete","head","options","patch","trace"],J={urls:{},tokens:new Map,globalOptions:{},mergeOptions:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.reduce(function(t,n){return Object.keys(t).filter(function(e){return w.PlainObject(t[e])}).forEach(function(e){var r=n[e];w.PlainObject(r)&&(n[e]=J.mergeOptions(t[e],r))}),Object.assign(t,n)},{})},setURLTokens:function(e){var o=J.tokens;Object.entries(e).forEach(function(e){var r=j(e,2),t=r[0],n=r[1];o.set(t,[RegExp("{"+t+"}","g"),n])})},setURLAlias:function(e,r){var t=J.urls;Object.entries(e).forEach(function(e){var r=j(e,2);t[r[0]]=r[1]}),w.Function(r)&&(J.URLTransform=r)},setDataTransform:function(e){w.Function(e)&&(J.dataTransform=e)},setAssert:function(e){w.Function(e)&&(J.assert=e)},URLTransform:function(e,r){var o=J.urls[e];return o?(r.forEach(function(e){var r=j(e,2),t=r[0],n=r[1];t.test(o)&&(o=o.replace(t,n))}),o):e},dataTransform:function(e,r,t,n){return r||t},assert:function(e,r,t,n){t(r)},setGlobalOptions:function(e){J.globalOptions=J.mergeOptions(J.globalOptions,e)}},G=function(i,u,c){return function(a){return function(e,r){var t=c.dataType,n=J.dataTransform;if(a)w.Function(c.assert)?c.assert(t,n(t,e,null,r),i,u):J.assert(t,n(t,e,null,r),i,u);else if(0===r.status){var o=r.aborted?"abort":"timeout";u(n(t,null,o,r))}else u(n(t,null,e,r))}}};function Q(e){return J.URLTransform(e,J.tokens)}function $(e){var r=e.method;return r||(e.data?"post":"get")}function _(e){for(var r=arguments.length,t=Array(1<r?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];var o=Object.assign.apply(Object,[e].concat(t));return delete o[z],o}function K(e,r){var t={};return w.String(e)?(t.url=e,w.PlainObject(r)&&_(t,r),t.method=$(t)):w.PlainObject(e)?(_(t,e),t.method=$(t)):w.Function(e)&&(t[z]=e),w.String(t.dataType)&&""!==t.dataType||(t.dataType="json"),w.String(t.url)&&(t.url=Q(t.url)),w.PlainObject(t.data)&&(t.data=Object.entries(t.data).reduce(function(e,r){var t=j(r,2),n=t[1];return e[t[0]]=w.Defined(n)?n:"",e},{})),t}function Y(r,t){return function(){var e=t.apply(void 0,arguments);return w.Defined(e)?r(e):r.apply(void 0,arguments)}}function Z(e,r){var t,u=void 0,n=void 0,i=null,o=null,a=null,c=null,s=null,l=[],f=[],p=(g(t={},B,!0),g(t,"then",function(e){o=o?Y(e,o):e}),g(t,"catch",function(e){a=a?Y(e,a):e}),g(t,"always",function(n){p.then(function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return n(null,r)}),p.catch(function(e){return n(e,null)})}),g(t,"before",function(e){c=c?Y(e,c):e}),g(t,"finally",function(e){s=s?Y(e,s):e}),g(t,"getXhr",function(){return n?n():l}),g(t,"abort",function(){for(var e=p.getXhr();e.length;)e.pop().abort()}),t);function y(t,o){if(i)if(u){var e=u;u=function(){return e.apply(void 0,arguments).ajax(t||o)}}else{var a=s;u=o?function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return o.apply(void 0,n).finally(function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return a.apply(void 0,n.concat(r))})}:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return Z(t).finally(function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return a.apply(void 0,n.concat(r))})},s=null}else f.push(t||o)}function d(e){l.splice(l.indexOf(e),1)}function h(){return f.reduce(function(e,r){var n,o,t,a=void 0;if(w.Function(r)){var i=r();x(W(i),"Function of ajax() expecting a ajax-object be returned."),a=i.getXhr()[0].always(function(){return d(a)})}else a=(n=r,o=void 0,t=new Promise(function(e,r){var t=G(e,r,n);o=I(n).then(t(!0)).catch(t(!1)).abort}),t.abort=o,t).always(function(){return d(a)});return e.push(a),e},l)}function m(e){x(W(e),"Function of ajax() expecting a ajax-object be returned."),n=e.getXhr}return V.forEach(function(n){p[n]=U(function(e){return r=e,t="ajax"===n?e.method:n,(r.url?(y(Object.assign(r,{method:t})),1):r[z]&&(y(null,r[z]),1))?p:b(p,V);var r,t},K)}),["then","catch","before","always","finally"].forEach(function(e){var r=p[e];p[e]=function(e){return e&&r(e),function(){if(!i){var e=h();c&&c.apply(void 0,O(e)),i=Promise.all(e).then(function(){var e=void 0;o&&(e=o.apply(void 0,arguments)),u&&(w.Defined(e)?m(u(e)):m(u.apply(void 0,arguments)))}).catch(function(e){a&&a(e)}).then(function(){s&&s()})}}(),p}}),[].concat(V,["before","then","catch","always","finally"]).forEach(function(n){var o=p[n];p[n]=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return u?(function(o){for(var e=arguments.length,t=Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var a=u,n=[].concat(V,["then","always","finally"]).includes(o),i=1===t.length&&w.Function(t[0])&&n?function(e){var r;return[(r=t[0]).bind.apply(r,[void 0].concat(O(e)))]}:function(){return t};u=function(){for(var e,r=arguments.length,t=Array(r),n=0;n<r;n++)t[n]=arguments[n];return(e=a.apply(void 0,t))[o].apply(e,O(i(t)))}}.apply(void 0,[n].concat(r)),p):o.apply(void 0,r)}}),p.ajax(e,J.mergeOptions(J.globalOptions,r))}return Object.assign(Z,b(J,["setURLTokens","setURLAlias","setDataTransform","setAssert","setGlobalOptions","mergeOptions"]),{getURL:Q}),Z});
